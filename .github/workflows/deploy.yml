#Name for Workflow
name: Bot deploy server
on:
  #Trigger workflow when code pushed to repo
  push:
    branches:
    #Branch which you want to deploy
      - main

jobs:
  deploy:
    #Run workflow on Ubuntu operating system(it's the bestest osüòÅ)
    runs-on: ubuntu-20.04

    steps:
    #Check code from repo
    - name: Checkout code  
      uses: actions/checkout@main
      
    #setting up Python
    - name: Set up Python
      uses: actions/setup-python@v2

    #install python required pakages for make repo working from requirements.txt
    - name: Install dependencies
      run: pip install -r requirements.txt

    #run the bot on workflow
  #  - name: Run Bot
  #    continue-on-error: true
      #setting Environmental Variables from Github secrets 
  #    env:
 #         API_ID: ${{ secrets.API_ID }}
  #        API_HASH: ${{ secrets.API_HASH }}
 #         BOT_TOKEN: ${{ secrets.BOT_TOKEN }}
      
      #start command (language directory where run codes are located
      #i am using python3 and codes file of pyrogram bot.py 
 #     run: python3 bot.py

    - name: running bot-deploy-server
      env:
          API_ID: ${{ secrets.API_ID }}
          API_HASH: ${{ secrets.API_HASH }}
          BOT_TOKEN: ${{ secrets.BOT_TOKEN }}
      timeout-minutes: 350
      continue-on-error: true
      run: |
        docker build . -t bot
        docker run bot
